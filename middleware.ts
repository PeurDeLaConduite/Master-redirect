import{NextResponse}from"next/server";import type{NextRequest}from"next/server";export function middleware(req:NextRequest){const{pathname,search}=req.nextUrl;if(pathname==="/robots.txt"||pathname==="/sitemap.xml"||pathname==="/favicon.ico"){return NextResponse.next()}const ua=req.headers.get("user-agent")||"";const isTablet=/(iPad|Tablet)/i.test(ua)||(/(Android)/i.test(ua)&&!/Mobile/i.test(ua));const isMobile=!isTablet&&/Mobi|Android|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(ua);const host=isMobile?"mobile.peur-de-la-conduite.fr":"desktop.peur-de-la-conduite.fr";const targetUrl=new URL(`${pathname}${search}`,`https://${host}`);const res=NextResponse.redirect(targetUrl,302);res.cookies.set("deviceType",isMobile?"mobile":"desktop",{path:"/",domain:".peur-de-la-conduite.fr",httpOnly:true,secure:true,sameSite:"strict"});return res}export const config={matcher:"/:path*"};